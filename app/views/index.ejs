<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>NEWSFLASH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Newsflash - the visual news tracker">
<meta name="author" content="James Drury">

<link href="assets/css/bootstrap.css" rel="stylesheet">
<link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
<link href="assets/css/extension.css" rel="stylesheet">
<link href="assets/css/typography.css" rel="stylesheet">
<link href="assets/css/font-awesome.min.css" rel="stylesheet">
<link href="stylesheets/jquery.fancybox.css" rel="stylesheet" type="text/css" media="screen" />
<link href="stylesheets/soundcloud/sc-player-minimal.css" rel="stylesheet" type="text/css" />
<link href="stylesheets/jquery.tweet.css" rel="stylesheet"/>
<link href="stylesheets/responsive-nav.css" rel="stylesheet">
<link href="stylesheets/styles.css" rel="stylesheet" type="text/css" media="screen" />
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>


<body>

<!-- Preloader -->
<div id="preloader">
  <div id="status">&nbsp;</div>
</div>


<!-- Mobile Only Navigation - 2 types each for (480px to 640px) and (640px to 960px) wide device screens -->
<header id="mobile-header" class="clearfix hidden-desktop">
    <div id="nav">
      <ul>
        <li><a href="#filter=.welcome" class="selected">Newsflash</a></li>
        <li><a href="#filter=.news">topics</a></li>
        <li><a href="#filter=.trending">trending</a></li>
        <li><a ref="#filter=.about">about</a></li>
      </ul>
    </div>
</header>

<header id="wrapper">

    <div id="options" class="clearfix visible-desktop">
      <ul id="filters" class="option-set clearfix" data-option-key="filter">
        <li><a class="reveal-bg-one selected" href="#filter=.welcome">Newsflash</a></li>
        <li><a class="reveal-bg-two" href="#filter=.news">topics</a></li>
        <li><a class="reveal-bg-three" href="#filter=.trending">trending</a></li>
        <li><a class="reveal-bg-nine" href="#filter=.about">about</a></li>
      </ul>
    </div>

</header>

<section class="container">
  <section id="container" class="clearfix">

    <article class="element  fx-slide-up home clearfix one-full welcome">
      <div class="one-third reveal-bg-one">
        <div class="thumb pad pad-bottom-minus"><img alt="reveal" title="reveal" src="images/home.png"/></div>
        <h2 class="welcome-heading pad pad-top-minus pad-bottom-minus"><span>Hi,</span>I'm Newsflash</h2>
        <br>
        <p class="pad pad-top-minus pad-bottom-minus">The visual news tracker.</p>
        <br>
        <div class="pad pad-top-minus">
        <a class="btn btn-reveal add-top-half" href="#filter=.trending">Let's get started <i class="fa fa-bolt"></i></a>
        </div>
      </div>
      <div class="two-third overflow">
        <div class="images"><img src="images/content/01.jpg" alt="" /></div>
      </div>
      <!-- dynamically update tweet count here -->
    </article>

    <article class="element  clearfix one-full about">
      <div class="reveal-bg-nine">
        <div class="thumb pad pad-bottom-minus"></div>
        <h2 class="welcome-heading pad pad-top-minus pad-bottom-minus">Newsflash is a visual news tracker</h2>
        <p class="pad pad-top-minus pad-bottom-minus">How it works:</p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> pulls breaking news from the <strong><em>The New York Times</em></strong> <a href="http://nyti.ms/PkaWYK">newswire</a></p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> translates each article into keywords using AlchemyAPI's artificial intelligence</p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> each article yields 2-3 keywords, and each keyword is assigned to the D3 treemap</p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> newsflash consults the list of keywords as it sifts through the Twitter stream</p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> when a tweet contains a keyword, newsflash populates the D3 treemap with hashtags from the matching tweet</p>
        <br>
        <p style="margin-right: 20px" class='pad pad-top-minus pad-bottom-minus'><i class="fa fa-bolt fa-6"></i> socket.io populates the treemap in real-time</p>
        <br>
        <br>
      </div>
    </article>

    <article class="element  clearfix one-full news">
      <div class="reveal-bg-two">
        <% if (masterlist) { %>
        <br>
        <h2 class="pad pad-top-minus pad-bottom-minus">Tracking <%= masterlist.children.length %> entities across 30 articles.</h2>
        <p class='pad pad-top-minus pad-bottom-minus'>
          <ul class='inline'>
            <% masterlist.children.forEach(function(entity) { %>
              <li style="list-style: none"><h4><%= entity.name %></h4></li>&#9;
            <% }); %>
          </ul>
        <% } %>
        <br>
      </div>
    </article>

    <article class="element  clearfix one-full trending">
      <div class="reveal-bg-nine">
      <div id="trending">
        <!-- insert treemap here -->
      </div>
    </div>
    </article>

  </section>
</section>

<footer id="mastfoot">
  <section class="container-fluid">
    <div class="row-fluid">
          <article class="span6 mob-center">
            <br>
            <h2 style="margin-left: 20px">Newsflash</h2>
            <p class="slogan">A visual representation of the news cycle.</p>
          </article>
          <article class="span6 text-right">
            <ul id="foot-icons" class="clearfix">
              <li><a href="http://www.jdrur.com" target="_blank"><img title="Personal Blog" alt="Personal Blog" src="images/social/footer_post.png"/></a></li>
              <li><a href="http://www.linkedin.com/in/jdrury86/" target="_blank"><img title="LinkedIn Account" alt="LinkedIn Account" src="images/social/footer_linkedin.png"/></a></li>
              <li><a href="https://github.com/jamesdrury/newsflash" target="_blank"><img title="Github Account" alt="Github Account" src="images/social/footer_github.png"/></a></li>
            </ul>
            <p class="copyright" href="http://www.fullstackacademy.com">Fullstack Academy &#9829; 2014</a></p>
          </article>
    </div>
  </section>
</footer>


<script src="/socket.io/socket.io.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
<script src="javascripts/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="javascripts/jquery.easing.1.3.js" type="text/javascript"></script>
<script src="javascripts/modernizr.js" type="text/javascript"></script>
<script src="assets/js/bootstrap-transition.js" ></script>
<script src="assets/js/bootstrap-alert.js" ></script>
<script src="assets/js/bootstrap-modal.js" ></script>
<script src="assets/js/bootstrap-dropdown.js" ></script>
<script src="assets/js/bootstrap-scrollspy.js" ></script>
<script src="assets/js/bootstrap-tab.js" ></script>
<script src="assets/js/bootstrap-tooltip.js" ></script>
<script src="assets/js/bootstrap-popover.js" ></script>
<script src="assets/js/bootstrap-button.js" ></script>
<script src="assets/js/bootstrap-collapse.js" ></script>
<script src="assets/js/bootstrap-carousel.js" ></script>
<script src="assets/js/bootstrap-typeahead.js" ></script>
<script src="assets/js/bootstrap-affix.js" ></script>

<script src="javascripts/jquery.ba-bbq.min.js" type="text/javascript"></script>
<script defer src="javascripts/jquery.flexslider.js"></script>
<script src="javascripts/jquery.isotope.min.js" type="text/javascript"></script>
<script src="javascripts/jquery.isotope.loader.js" type="text/javascript"></script>
<script src="javascripts/jquery.fancybox.pack.js" type="text/javascript"></script>
<script src="javascripts/scrollup.js" type="text/javascript"></script>
<script src="javascripts/responsive-nav.js" type="text/javascript"></script>
<script src="javascripts/preloader.js" type="text/javascript"></script>
<script src="javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="javascripts/form-validation.js"></script>
<script src="javascripts/jquery.fitvids.js"></script>
<script src="javascripts/soundcloud.player.api.js"></script>
<script src="javascripts/sc-player.js"></script>
<script src="javascripts/script.js" type="text/javascript"></script>

<script>
var socket = io.connect();

var containerWidth = $(window).innerWidth();
var containerHeight = $(window).innerHeight();

var margin = {top: 10, right: 10, bottom: 10, left: 10},
    width = containerWidth - (containerWidth * .40),
    height = containerHeight - (containerHeight * .36);

var color = d3.scale.category20c();

var treemap = d3.layout.treemap()
  .size([width, height])
  .sticky(false)
  .value(function(d) { return d.size; });

var div = d3.select("#trending").append("div")
  .style("position", "relative")
  .style("width", (width + margin.left + margin.right) + "px")
  .style("height", (height + margin.top + margin.bottom) + "px")
  .style("left", margin.left + "px")
  .style("top", margin.top + "px");

var root;
var startDate = new Date();

socket.on('update', function(stream) {
console.log('tweets')

var now = new Date();
if( (now - startDate) < 2000 ) {
  return;
}
startDate = new Date();

div.datum(root).selectAll(".node").remove();

root = stream.masterlist;

var node = div.datum(root).selectAll(".node")
    .data(treemap.nodes)
  .enter().append("div")
    .attr("class", "node")
    .call(position)
    .style("background", function(d) { return d.children ? color(d.name) : null; })
    .text(function(d) { return d.children ? null : d.name; });

d3.selectAll("input").on("change", function change() {
  var value = this.value === "count"
      ? function() { return 1; }
      : function(d) { return d.size; };

  node
      .data(treemap.value(value).nodes)
    .transition()
      .duration(1500)
      .call(position);
  });
});

function position() {
this.style("left", function(d) { return d.x + "px"; })
    .style("top", function(d) { return d.y + "px"; })
    .style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
    .style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
}
</script>


<script>
  var navigation = responsiveNav("#nav", { // Selector: The ID of the wrapper
    animate: true, // Boolean: Use CSS3 transitions, true or false
    transition: 400, // Integer: Speed of the transition, in milliseconds
    label: "Menu", // String: Label for the navigation toggle
    insert: "after", // String: Insert the toggle before or after the navigation
    customToggle: "", // Selector: Specify the ID of a custom toggle
    openPos: "relative", // String: Position of the opened nav, relative or static
    jsClass: "js", // String: 'JS enabled' class which is added to <html> el
    init: function(){}, // Function: Init callback
    open: function(){}, // Function: Open callback
    close: function(){} // Function: Close callback
  });
</script>


</body>
</html>